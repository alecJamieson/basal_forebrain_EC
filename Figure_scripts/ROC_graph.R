#Supplementary Fig. S3
library(pROC)

#Data concerning actual and predicted diagnostic status
actual <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)

predicted <- c(-1.3725, 1.1494, -2.5811, 1.908, -0.8658, 0.0106, 0.8315, 0.3149, 0.2273, 0.0271, -1.4128, 
               0.0165, 1.3597, 0.3026, -1.0712, 0.5981, -0.9276, 1.9508, 1.0524, -0.2449, 0.3993, -4.4411, 
               -0.7891, -1.0241, 1.4713, 0.0072, 0.5254, 0.174, 0.6256, -1.7731, -2.0993, 0.003, -0.7734, 
               0.5499, -0.5901, -0.5758, -1.0157, -0.5686, -2.1838, -0.2196, 0.5546, -0.3515, -0.4772, 
               -0.0024, 0.0372, 0.6965, -1.0503, 2.0987, -0.47, 2.0843, -0.9558, 0.0128, 0.9409, 0.0467, 
               1.0808, -1.4884, 0.666, -0.7615, -0.0036, 1.0377, -0.1485, -0.6771, 0.6958, 0.1238, 1.0668, 
               -0.0364, 1.4039, 0.83, -0.8232, 0.5858, -1.1492, -1.8442, 0.4095, -0.441, 1.2729, -1.7073, 
               -1.9964, 1.1328, 2.3351, 0.4673, 0.3688, 0.5303, 0.5366, 1.8851, 1.3208, 1.0364, 2.1401, 
               0.4117, 0.8765, -0.1155, 0.0575, -0.6478, 0.7137, 0.4746, 1.1019, -0.8064, -0.1234, 0.2646, 
               1.4131, 0.2672, -1.7527, 1.6017, 0.8927, 0.0411, -2.4501, -0.3234, 0.7857, 0.0112, 0.2985, 
               -0.0861, -0.5825, 1.9862, 0.5427, -0.6339, 0.0035, -0.3751, 0.3858, -1.0786, -0.3673, 0.3725, 
               0.1834, 1.6774, 2.1836, 0.6623, 0.0023, 0.7739, 3.2229, 0.7771, 0.8527, 0.3081, 0.8365, 
               1.8051, -0.0046, 1.2652, -0.0159, 1.9098, 0.9391, 0.1475, 0.9833, 0.4612, 3.6791, 0.568, 
               2.0548, 1.1247, 1.7578, -0.2365, 0.1979) #From LOO_diagnosis.mat

# Print results rounded to 2 decimal places
print(paste("AUC:", round(auc_result, 2)))
print(paste("95% CI:", round(ci_result[1], 2), "-", round(ci_result[3], 2)))
print(paste("Optimal cutoff:", round(optimal_cutoff, 2)))
print(paste("Sensitivity at optimal cutoff:", round(sensitivity, 2)))
print(paste("Specificity at optimal cutoff:", round(specificity, 2)))
par(pty = "s")

# Plot ROC curve
plot(roc_obj, 
     main = "ROC Curve", 
     col = "#0073C2FF", 
     lwd = 4)

# Add AUC and CI to the plot
legend("bottomright", 
       legend = c(paste("AUC =", round(auc_result, 2)),
                  paste("95% CI:", round(ci_result[1], 2), "-", round(ci_result[3], 2))),
       bty = "n")
